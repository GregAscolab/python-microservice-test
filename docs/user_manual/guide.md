# User Manual

## 1. Introduction

This guide provides complete instructions for setting up the necessary prerequisites, installing the application dependencies, and running the full microservice suite. Following this guide will allow you to run the application on your local machine for development or testing purposes.

## 2. System Requirements

Before you begin, ensure your system has the following software installed:

-   **Python:** Version 3.9 or higher.
-   **pip:** The Python package installer (usually comes with Python).
-   **Docker:** (Recommended) For easily running the NATS server. If you cannot use Docker, you can [install a native NATS server](https://docs.nats.io/nats-server/installation).
-   **Git:** For cloning the application repository.

## 3. Installation

Follow these steps to get the application ready to run.

### Step 1: Clone the Repository

Open a terminal and clone the repository to your local machine.

```bash
# Replace <repository_url> with the actual URL of the git repository
git clone <repository_url>
cd <repository_directory>
```

### Step 2: Install Python Dependencies

The project uses a set of Python packages listed in the `requirements.txt` file. Install them using `pip`.

```bash
pip install -r requirements.txt
```

### Step 3: Set Up the NATS Server

The microservices require a NATS server for communication. Crucially, the `ui_service` requires that the NATS server has **WebSocket support enabled** to allow the frontend to connect.

The easiest way to run a properly configured NATS server is by using Docker in conjunction with the `nats-server.conf` file provided in this repository.

1.  **Review the Configuration:** The `nats-server.conf` file in the root of this repository contains the necessary block to enable WebSockets:
    ```
    websocket {
        port: 4223
        no_tls: true
    }
    ```
    This tells the NATS server to listen for insecure WebSocket connections on port `4223`.

2.  **Run the NATS Server with Docker:**
    From the **root of the project directory**, run the following command. This command mounts the local configuration file into the Docker container and tells the server to use it.

    ```bash
    # For Linux/macOS:
    docker run --name nats-main -p 4222:4222 -p 8222:8222 -p 4223:4223 -v "$(pwd)/nats-server.conf":/etc/nats/nats-server.conf nats:latest -c /etc/nats/nats-server.conf

    # For Windows (Command Prompt):
    # docker run --name nats-main -p 4222:4222 -p 8222:8222 -p 4223:4223 -v "%cd%/nats-server.conf":/etc/nats/nats-server.conf nats:latest -c /etc/nats/nats-server.conf
    ```

    This command starts a NATS server and exposes the necessary ports:
    -   `4222`: For standard TCP connections from the backend services.
    -   `8222`: For HTTP monitoring. You can check the server status at `http://localhost:8222`.
    -   `4223`: For the WebSocket connections required by the UI service.

For more detailed information on NATS WebSocket configuration, please refer to the [official NATS documentation](https://docs.nats.io/running-a-nats-service/configuration/websocket/websocket_conf).

## 4. Running the Application

The entire application is started via a single entry point: the `main.py` script at the root of the repository. This script starts the **Manager Service**, which then automatically discovers and starts all the other services in the correct order.

### To Start the Application:

In your terminal, from the root directory of the project, run:

```bash
python main.py
```

### Expected Output

You will see logs from the `manager` service first as it starts up. It will then discover and launch the other services, starting with the critical `settings_service`. Subsequently, you will see interleaved logs from all the individual services as they initialize and start their tasks.

### Accessing the UI

Once the `ui_service` has started, you can access the web interface by navigating your browser to the address shown in its startup logs. The default address is:

**`http://localhost:8000`**

## 5. Monitoring the Application

There are several ways to monitor the health and status of the application:

-   **Console Logs:** The primary way to monitor the application is by observing the console output from the `main.py` script. All logs (`INFO`, `WARNING`, `ERROR`, etc.) from all services are streamed to this single console in real-time.
-   **UI Service "Manager" Page:** The web interface has a dedicated page for monitoring the status of all microservices. This page visualizes the data from the `manager.status` NATS subject, showing which services are running, stopped, or have crashed.
-   **UI Service "Logs" Page:** The UI also provides a page where you can view the historical log files (`.log`) generated by each service. This is useful for debugging a specific service without having to find the file on the server.

## 6. Stopping the Application

To stop the entire application, press `Ctrl+C` in the terminal where the `main.py` script is running. The Manager Service is designed to intercept this shutdown signal and perform a graceful shutdown of all the services it started before exiting.
